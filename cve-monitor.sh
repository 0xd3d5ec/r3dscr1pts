#!/bin/bash

# NVD CVE API URL
NVD_API_URL="https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-recent.json"

# Xfce notification command
XFCE_NOTIFY_CMD="xfce4-notify-dialog"

# Get the latest CVEs from the NVD API
CVE_DATA=$(curl -s $NVD_API_URL)

# Parse the CVE data
CVES=$(echo $CVE_DATA | jq -r '[.CVE_Items[]]')

# Loop through the CVEs and send a notification for each one
for CVE in $CVES; do

  # Get the CVE details
  CVE_ID=$(echo $CVE | jq -r .CVE_data_id)
  CVE_DESCRIPTION=$(echo $CVE | jq -r .description)
  CVE_LINK=$(echo $CVE | jq -r .cve_url)

  # Send the notification
  $XFCE_NOTIFY_CMD -i -t "CVE $CVE_ID" -m "$CVE_DESCRIPTION" -a "$CVE_LINK"

done
