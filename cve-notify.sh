#!/bin/bash

# Get the latest CVEs from the NVD database
curl -s https://nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-published.xml.gz | gunzip -c > /tmp/cve.xml

# Parse the CVE XML file
xmlstarlet sel -t -m "//cve/CVE_Items/CVE_Item" /tmp/cve.xml | while read cve; do

  # Get the CVE details
  CVE_ID=$(echo $cve | xmlstarlet sel -t -c "./@CVE_ID")
  CVE_Description=$(echo $cve | xmlstarlet sel -t -c "./Description/text()")
  CVE_PublishedDate=$(echo $cve | xmlstarlet sel -t -c "./PublishedDate/text()")
  CVE_ModifiedDate=$(echo $cve | xmlstarlet sel -t -c "./ModifiedDate/text()")

  # Create a notification
  notification=$(echo "$CVE_ID - $CVE_Description" | xmessage -center -file -)

  # Push the notification to the Xfce desktop environment
  xfce4-notify -c "CVE Notification" "$notification"
done
